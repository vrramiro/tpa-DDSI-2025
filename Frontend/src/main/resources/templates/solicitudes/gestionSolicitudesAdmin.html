<html th:replace="~{layout/base:: html}">
<head>
    <th:block th:fragment="styles">
        <link th:href="@{/css/solicitudes/gestionSolicitudes.css}" rel="stylesheet">
        <link th:href="@{/css/colecciones/coleccionesSistema.css}" rel="stylesheet">
        <link th:href="@{/css/colecciones/gestionColecciones.css}" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    </th:block>
</head>

<div th:fragment="contenido" class="row">
    <section class="content-container">
        <div class="solicitud-header">
            <h2>Solicitudes de Eliminaci칩n</h2>

            <div class="filter-controls">
                <form th:action="@{/solicitudes/gestion}" method="get">
                    <label for="status-filter">Filtrar por estado:</label>
                    <select id="status-filter" name="estado" onchange="this.form.submit()">
                        <option value="" th:selected="${param.estado == null}">Todos</option>
                        <option value="ACEPTADA" th:selected="${param.estado == 'ACEPTADA'}">Aprobadas</option>
                        <option value="PENDIENTE" th:selected="${param.estado == 'PENDIENTE'}">Pendientes</option>
                        <option value="RECHAZADA" th:selected="${param.estado == 'RECHAZADA'}">Rechazadas</option>
                    </select>
                </form>
            </div>
        </div>

        <!-- Mensajes -->
        <div th:if="${mensaje}" class="alert alert-success mt-2" th:text="${mensaje}"></div>
        <div th:if="${error}" class="alert alert-danger mt-2" th:text="${error}"></div>

        <div class="table-container">
            <table class="tabla-colecciones">
                <thead>
                <tr>
                    <th>ID</th>
                    <th>Fecha Creaci칩n</th>
                    <th>Fecha Evaluaci칩n</th>
                    <th>Estado</th>
                    <th class="text-end">Acciones</th>
                </tr>
                </thead>
                <tbody>

                <tr th:if="${#lists.isEmpty(solicitudes)}">
                    <td colspan="5" class="muted text-center" style="padding: 2rem;">
                        No hay solicitudes para mostrar.
                    </td>
                </tr>

                <tr th:each="solicitud : ${solicitudes}">
                    <td th:text="${solicitud.idSolicitud}">1</td>

                    <td th:text="${#temporals.format(solicitud.fechaDeCreacion, 'dd/MM/yyyy')}">01/01/2025</td>

                    <td th:text="${solicitud.fechaDeEvaluacion != null ? #temporals.format(solicitud.fechaDeEvaluacion, 'dd/MM/yyyy') : '-'}">-</td>

                    <td>
                        <span th:classappend="${solicitud.estadoDeSolicitud == 'ACEPTADA'} ? 'badge bg-success'
                                      : (solicitud.estadoDeSolicitud == 'RECHAZADA' ? 'badge bg-danger' : 'badge bg-warning')"
                              th:text="${solicitud.estadoDeSolicitud}">PENDIENTE</span>
                    </td>

                    <td class="action-buttons">
                        <a th:href="@{/solicitudes/panel/solicitudId(id=${solicitud.idSolicitud})}"
                           class="btn btn-primary btn-sm"
                           title="Ver detalles">
                            <i class="fa-solid fa-eye"></i> Ver m치s
                        </a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="footer-actions mt-4">
            <a th:href="@{/solicitudes/crear}" class="btn btn-primary">Nueva Solicitud</a>
        </div>
        <div class="footer-actions">
            <a th:href="@{/panel_gestion}" class="btn btn-secondary">Volver al Panel</a>
        </div>
    </section>

    <th:block th:fragment="scripts">
        <script th:src="@{/js/solicitudes/gestionSolicitudes.js}"></script>
    </th:block>
</div>
</html>
