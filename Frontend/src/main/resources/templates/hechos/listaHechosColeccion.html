<html th:replace="~{layout/base::html}" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <th:block th:fragment="styles">
        <link th:href="@{/css/colecciones/crearColecciones.css}" rel="stylesheet">
        <link th:href="@{/css/hechos/listaHechosColeccion.css}" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    </th:block>
</head>

<div th:fragment="contenido" class="row">
    <main class="main-container">

        <section class="coleccion-info-card">
            <div class="info-header">
                <h1 th:text="${coleccion.titulo}">Título de la Colección</h1>
            </div>

            <div class="info-body">
                <p class="description" th:text="${coleccion.descripcion}">Descripción de la colección...</p>

                <div class="meta-grid">
                    <div class="meta-item">
                        <strong>Consenso:</strong>
                        <span th:text="${coleccion.consenso != null ? #strings.capitalize(#strings.toLowerCase(coleccion.consenso.toString().replace('_', ' '))) : 'No definido'}"></span>
                    </div>

                    <div class="meta-item">
                        <strong>Fuentes:</strong>
                        <ul class="lista-inline">
                            <th:block th:if="${coleccion.fuentes != null}">
                                <li th:each="fuente : ${coleccion.fuentes}"
                                    th:if="${fuente != null}"
                                    class="tag-fuente">
                                    <span th:text="${#strings.capitalize(fuente.name().toLowerCase())}">Fuente</span>
                                </li>
                            </th:block>
                            <span th:if="${coleccion.fuentes == null or coleccion.fuentes.isEmpty()}" class="text-muted">Sin fuentes</span>
                        </ul>
                    </div>
                </div>

                <div class="criterios-section" th:if="${not #lists.isEmpty(coleccion.criterios)}">
                    <h3>Criterios de Pertenencia</h3>
                    <div class="tags-criterios-container">
                        <span class="tag-criterio" th:each="criterio : ${coleccion.criterios}" th:if="${criterio.tipo != null}">
                            <i class="fas fa-filter"></i>
                            <strong th:text="${#strings.capitalize(#strings.replace(criterio.tipo?.name(), '_', ' ').toLowerCase())}">TIPO</strong>:
                            <span th:text="${criterio.valor}">Valor</span>
                        </span>
                    </div>
                </div>
            </div>

            <div class="info-actions">
                <a th:href="@{/colecciones}" class="btn btn-secondary">Volver a Colecciones</a>
            </div>
        </section>

        <hr class="divider">

        <section class="hechos-section">
            <h2>Hechos en esta colección</h2>

            <div th:if="${#lists.isEmpty(hechos)}" class="empty-state">
                <p>No hay hechos asociados a esta colección actualmente.</p>
            </div>

            <div class="hechos-list" th:unless="${#lists.isEmpty(hechos)}">
                <div class="hecho-card" th:each="hecho : ${hechos}">

                    <div class="hecho-card-content">
                        <h3 class="hecho-title" th:text="${hecho.titulo}">Título del Hecho</h3>
                        <p class="hecho-desc" th:text="${hecho.descripcion}">Descripción del hecho...</p>

                        <div class="hecho-tags-container">

                            <span class="meta-tag tag-date" th:if="${hecho.fechaAcontecimiento != null}">
                                <i class="fas fa-calendar-alt"></i>
                                <span th:text="${#temporals.format(hecho.fechaAcontecimiento, 'dd/MM/yyyy')}">Fecha</span>
                            </span>

                            <span class="meta-tag tag-category" th:if="${hecho.categoria != null}">
                                <i class="fas fa-tag"></i>
                                <span th:text="${hecho.categoria}">Categoría</span>
                            </span>

                            <span class="meta-tag tag-location" th:if="${hecho.ubicacion != null}">
                                <i class="fas fa-map-marker-alt"></i>
                                <span th:text="${hecho.ubicacion.provincia} + ', ' + ${hecho.ubicacion.pais}">Ubicación</span>
                            </span>

                            <span class="meta-tag tag-status"
                                  th:if="${hecho.estado != null}"
                                  th:classappend="${'status-' + #strings.toLowerCase(hecho.estado)}"
                                  th:text="${#strings.capitalize(#strings.toLowerCase(hecho.estado))}">
                                Estado
                            </span>
                        </div>
                    </div>

                    <div class="hecho-card-actions">
                        <a th:href="@{/hechos/{id}(id=${hecho.id})}" class="btn btn-outline">Ver Detalle</a>
                    </div>
                </div>
            </div>

            <div class="pagination-wrapper" th:if="${not #lists.isEmpty(hechos)}">
                <div th:replace="~{navegacion/navegacion :: pager(
                    ${page},
                    ${totalPages},
                    ${size},
                    ${baseUrl},
                    '',
                    '',
                    ${isFirst},
                    ${isLast}
                )}"></div>
            </div>

        </section>

    </main>

    <th:block th:fragment="scripts">
        <script th:src="@{/js/hechos/listaHechosColeccion.js}"></script>
    </th:block>
</div>
</html>