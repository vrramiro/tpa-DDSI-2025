<html th:replace="~{layout/base::html}">

<head>
    <!-- CSS específico de esta vista -->
    <th:block th:fragment="styles">
        <link th:href="@{/css/hechos/hecho.css}" rel="stylesheet">
    </th:block>
</head>

<div th:fragment="contenido">

    <main class="hecho-container">
        <div class="hecho-card">
            <div class="hecho-meta">
                <a th:if="${hecho.estado.name() != 'RECHAZADO'}"
                   th:href="@{/hechos/{id}/editar(id=${hecho.id})}"
                   class="btn btn-editar">Editar</a>

                <span class="hecho-fecha"
                      th:text="${#temporals.format(hecho.fechaAcontecimiento, 'dd/MM/yyyy')}">01/08/2025</span>
            </div>
            <div class="hecho-header">
                <h1 class="hecho-titulo" th:text="${hecho.titulo}">Título del hecho</h1>
            </div>

            <img th:if="${!hecho.contenidoMultimedia.isEmpty()}"
                 class="hecho-imagen"
                 th:src="${hecho.contenidoMultimedia[0].url}"
                 alt="Imagen del hecho">

            <div class="hecho-meta-info">
                <p class="hecho-autor"><strong>Autor:</strong> Juan Pérez</p>
                <span class="hecho-categoria" th:text="${hecho.categoria}">Categoría</span>
            </div>

            <p class="hecho-descripcion" th:text="${hecho.descripcion}">
                Más de 2000 personas marcharon reclamando derechos laborales en la capital. La convocatoria fue masiva y se extendió durante varias horas de forma pacífica.
            </p>

            <p class="hecho-estado">
                <strong>Estado:</strong>
                <span th:class="'badge badge-' + ${hecho.estado.name().toLowerCase()}"
                      th:text="${hecho.estado}">PENDIENTE</span>
            </p>

            <div class="hecho-footer">
                <div class="hecho-botones">
                    <a href="#" onclick="history.back()" class="btn btn-volver">Volver</a>

                    <a th:href="@{/solicitudes/nueva(hechoId=${hecho.id})}" class="btn btn-danger">Solicitud de eliminación</a>

                    <form th:if="${hecho.estado.name() == 'PENDIENTE'}"
                          th:action="@{/hechos/{id}/rechazar(id=${hecho.id})}"
                          method="post" style="display: inline;">
                        <button type="submit" class="btn btn-danger">Rechazar</button>
                    </form>

                    <form th:if="${hecho.estado.name() == 'PENDIENTE'}"
                          th:action="@{/hechos/{id}/aceptar(id=${hecho.id})}"
                          method="post" style="display: inline;">
                        <button type="submit" class="btn btn-primary">Aceptar</button>
                    </form>

                    <a th:href="@{/explorador(lat=${hecho.ubicacion.latitud},lng=${hecho.ubicacion.longitud})}" class="btn btn-primary">Ver en mapa</a>
                </div>
            </div>
        </div>
    </main>


    <th:block th:fragment="scripts">
        <script th:src="@{/js/hechos/gestionHecho.js}"></script>
    </th:block>

</div>
</html>